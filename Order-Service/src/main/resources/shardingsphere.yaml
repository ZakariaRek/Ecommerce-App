dataSources:
  shard0:
    url: jdbc:postgresql://localhost:5432/Order-service
    username: postgres
    password: yahyasd56
    driverClassName: org.postgresql.Driver
    type: com.zaxxer.hikari.HikariDataSource
  shard1:
    url: jdbc:postgresql://localhost:5432/Order-service-shard-1
    username: postgres
    password: yahyasd56
    driverClassName: org.postgresql.Driver
    type: com.zaxxer.hikari.HikariDataSource
  shard2:
    url: jdbc:postgresql://localhost:5432/Order-service-shard-2
    username: postgres
    password: yahyasd56
    driverClassName: org.postgresql.Driver
    type: com.zaxxer.hikari.HikariDataSource
  shard3:
    url: jdbc:postgresql://localhost:5432/Order-service-shard-3
    username: postgres
    password: yahyasd56
    driverClassName: org.postgresql.Driver
    type: com.zaxxer.hikari.HikariDataSource

rules:
  - !SHARDING
    tables:
      orders:
        actualDataNodes: shard${0..3}.orders
        databaseStrategy:
          standard:
            shardingColumn: user_id
            shardingAlgorithmName: user-hash-mod
      order_items:
        actualDataNodes: shard${0..3}.order_items
        databaseStrategy:
          standard:
            shardingColumn: order_id
            shardingAlgorithmName: order-hash-mod
      discount_applications:
        actualDataNodes: shard${0..3}.discount_applications
        databaseStrategy:
          standard:
            shardingColumn: order_id
            shardingAlgorithmName: order-hash-mod

    shardingAlgorithms:
      user-hash-mod:
        type: HASH_MOD
        props:
          sharding-count: 4
      order-hash-mod:
        type: HASH_MOD
        props:
          sharding-count: 4

props:
  sql-show: true